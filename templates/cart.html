{% extends 'base.html' %}

{% block title %}–ö–æ—à–∏–∫ - Steam Store{% endblock %}

{% block content %}
<div class="header">
    <h1>üõí –í–∞—à –∫–æ—à–∏–∫</h1>
    <p>–¢–æ–≤–∞—Ä—ñ–≤ —É –∫–æ—à–∏–∫—É: {{ cart_count }}</p>
</div>

{% if games %}
<div class="cart-container">
    <div class="cart-items">
        {% for game in games %}
        <div class="cart-item">
            <div class="cart-item-image">
                <img src="/static/images/{{ game.image }}" 
                     alt="{{ game.title }}"
                     onerror="this.parentElement.innerHTML='<div class=cart-placeholder>üì∑</div>'">
            </div>
            <div class="cart-item-info">
                <h3 class="cart-item-title">{{ game.title }}</h3>
                <div class="cart-item-tags">
                    {% for tag in game.tags %}
                    <span class="tag-small">{{ tag }}</span>
                    {% endfor %}
                </div>
            </div>
            <div class="cart-item-price">
                {% if game.discount > 0 %}
                <span class="discount-badge">-{{ game.discount }}%</span>
                {% endif %}
                <span class="cart-price">{{ game.current_price }} ‚Ç¥</span>
            </div>
            <form method="POST" action="/remove-from-cart/{{ game.id }}" class="cart-item-remove">
                <button type="submit" class="remove-button">‚úï</button>
            </form>
        </div>
        {% endfor %}
    </div>

    <div class="cart-summary">
        <div class="summary-card">
            <h2 class="summary-title">–ü—ñ–¥—Å—É–º–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
            <div class="summary-row">
                <span>–¢–æ–≤–∞—Ä—ñ–≤:</span>
                <span>{{ cart_count }}</span>
            </div>
            <div class="summary-row">
                <span>–í–∞—à –±–∞–ª–∞–Ω—Å:</span>
                <span class="balance-amount">{{ balance }} ‚Ç¥</span>
            </div>
            <div class="summary-row summary-total">
                <span>–î–æ —Å–ø–ª–∞—Ç–∏:</span>
                <span class="total-price">{{ total }} ‚Ç¥</span>
            </div>
            
            {% if balance >= total %}
            <form method="POST" action="/checkout">
                <button type="submit" class="checkout-button">üí≥ –û–ø–ª–∞—Ç–∏—Ç–∏ ({{ total }} ‚Ç¥)</button>
            </form>
            {% else %}
            <button class="checkout-button disabled" disabled>‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ—à—Ç—ñ–≤</button>
            <p class="insufficient-funds">–ë—Ä–∞–∫—É—î {{ total - balance }} ‚Ç¥</p>
            {% endif %}
            
            <form method="POST" action="/clear-cart">
                <button type="submit" class="clear-cart-button">–û—á–∏—Å—Ç–∏—Ç–∏ –∫–æ—à–∏–∫</button>
            </form>
        </div>
    </div>
</div>
{% else %}
<div class="empty-cart">
    <div class="empty-cart-icon">üõí</div>
    <h2>–í–∞—à –∫–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</h2>
    <p>–î–æ–¥–∞–π—Ç–µ —ñ–≥—Ä–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–∞–≥–∞–∑–∏–Ω—É</p>
    <a href="/" class="back-to-store">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –º–∞–≥–∞–∑–∏–Ω—É</a>
</div>
{% endif %}
{% endblock %}